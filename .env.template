# NCL Environment Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# REQUIRED: Supabase Configuration
# =============================================================================
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-service-role-key
SUPABASE_DB_URL=postgresql://postgres:password@db.your-project.supabase.co:5432/postgres

# =============================================================================
# REQUIRED: OpenAI Configuration
# =============================================================================
OPENAI_API_KEY=sk-your-openai-key

# =============================================================================
# Model Configuration
# =============================================================================
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSIONS=1536
LLM_MODEL=gpt-4o-mini

# =============================================================================
# Chunking Configuration
# =============================================================================
CHUNK_SIZE_TOKENS=512
CHUNK_OVERLAP_TOKENS=50

# =============================================================================
# File Storage Paths
# =============================================================================
# Source data (user-provided, read-only) - supports subdirectories
DATA_SOURCE_DIR=./data/source

# Processed data (NCL-generated) - attachments and extracted files
DATA_PROCESSED_DIR=./data/processed

# Folder structure:
# data/
# ├── source/           # Place your EML files here (can use subdirectories)
# │   ├── inbox/
# │   ├── archive/2024/
# │   └── ...
# └── processed/        # NCL creates this automatically
#     ├── attachments/  # Extracted email attachments
#     └── extracted/    # Extracted ZIP contents

# =============================================================================
# Processing Options
# =============================================================================
BATCH_SIZE=10
MAX_CONCURRENT_EMBEDDINGS=5
EMBEDDING_BATCH_SIZE=100
ENABLE_OCR=true
ENABLE_PICTURE_DESCRIPTION=true

# =============================================================================
# ZIP Extraction Limits (DoS protection)
# =============================================================================
ZIP_MAX_FILES=100
ZIP_MAX_DEPTH=3
ZIP_MAX_TOTAL_SIZE_MB=500

# =============================================================================
# Reranker Configuration (improves search accuracy by 20-35%)
# =============================================================================
RERANK_ENABLED=true
RERANK_MODEL=cohere/rerank-english-v3.0
RERANK_TOP_N=5
COHERE_API_KEY=your-cohere-api-key

# =============================================================================
# Display and Output
# =============================================================================
# Maximum characters of chunk content to display in source references
CHUNK_DISPLAY_MAX_CHARS=500

# Maximum error message length stored in database
ERROR_MESSAGE_MAX_LENGTH=1000

# =============================================================================
# API Configuration (for web interface)
# =============================================================================
# JWT secret from Supabase dashboard (Settings > API > JWT Secret)
SUPABASE_JWT_SECRET=your-jwt-secret

# CORS origins (comma-separated for multiple origins)
CORS_ORIGINS=http://localhost:5173

# API server settings
API_HOST=0.0.0.0
API_PORT=8000
